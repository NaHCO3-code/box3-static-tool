(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const p of n.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function o(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=o(i);fetch(i.href,n)}})();const v={".aac":"audio/aac",".abw":"application/x-abiword",".apng":"image/apng",".arc":"application/x-freearc",".avif":"image/avif",".avi":"video/x-msvideo",".azw":"application/vnd.amazon.ebook",".bin":"application/octet-stream",".bmp":"image/bmp",".bz":"application/x-bzip",".bz2":"application/x-bzip2",".cda":"application/x-cdf",".csh":"application/x-csh",".css":"text/css",".csv":"text/csv",".doc":"application/msword",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".eot":"application/vnd.ms-fontobject",".epub":"application/epub+zip",".gz":"application/gzip",".gif":"image/gif",".htm":"text/html",".ico":"image/vnd.microsoft.icon",".ics":"text/calendar",".jar":"application/java-archive",".jpeg":"image/jpeg",".jpg":"image/jpg",".js":"text/javascript",".json":"application/json",".jsonld":"application/ld+json",".mid":"audio/midi",".mjs":"text/javascript",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpeg":"video/mpeg",".mpkg":"application/vnd.apple.installer+xml",".odp":"application/vnd.oasis.opendocument.presentation",".ods":"application/vnd.oasis.opendocument.spreadsheet",".odt":"application/vnd.oasis.opendocument.text",".oga":"audio/ogg",".ogv":"video/ogg",".ogx":"application/ogg",".opus":"audio/opus",".otf":"font/otf",".png":"image/png",".pdf":"application/pdf",".php":"application/x-httpd-php",".ppt":"application/vnd.ms-powerpoint",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".rar":"application/vnd.rar",".rtf":"application/rtf",".sh":"application/x-sh",".svg":"image/svg+xml",".tar":"application/x-tar",".tif":"image/tiff",".ts":"video/mp2t",".ttf":"font/ttf",".txt":"text/plain",".vsd":"application/vnd.visio",".wav":"audio/wav",".weba":"audio/webm",".webm":"video/webm",".webp":"image/webp",".woff":"font/woff",".woff2":"font/woff2",".xhtml":"application/xhtml+xml",".xls":"application/vnd.ms-excel",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xml":"RFC 7303",".xul":"application/vnd.mozilla.xul+xml",".zip":"application/zip",".3gp":"video/3gpp",".3g2":"video/3gpp2",".7z":"application/x-7z-compressed"},f={"audio/aac":".aac","application/x-abiword":".abw","image/apng":".apng","application/x-freearc":".arc","image/avif":".avif","video/x-msvideo":".avi","application/vnd.amazon.ebook":".azw","application/octet-stream":".bin","image/bmp":".bmp","application/x-bzip":".bz","application/x-bzip2":".bz2","application/x-cdf":".cda","application/x-csh":".csh","text/css":".css","text/csv":".csv","application/msword":".doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":".docx","application/vnd.ms-fontobject":".eot","application/epub+zip":".epub","application/gzip":".gz","image/gif":".gif","text/html":".htm","image/vnd.microsoft.icon":".ico","text/calendar":".ics","application/java-archive":".jar","image/jpeg":".jpeg","text/javascript":".mjs","application/json":".json","application/ld+json":".jsonld","audio/midi":".mid","audio/mpeg":".mp3","video/mp4":".mp4","video/mpeg":".mpeg","application/vnd.apple.installer+xml":".mpkg","application/vnd.oasis.opendocument.presentation":".odp","application/vnd.oasis.opendocument.spreadsheet":".ods","application/vnd.oasis.opendocument.text":".odt","audio/ogg":".oga","video/ogg":".ogv","application/ogg":".ogx","audio/opus":".opus","font/otf":".otf","image/png":".png","application/pdf":".pdf","application/x-httpd-php":".php","application/vnd.ms-powerpoint":".ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":".pptx","application/vnd.rar":".rar","application/rtf":".rtf","application/x-sh":".sh","image/svg+xml":".svg","application/x-tar":".tar","image/tiff":".tif","video/mp2t":".ts","font/ttf":".ttf","text/plain":".txt","application/vnd.visio":".vsd","audio/wav":".wav","audio/webm":".weba","video/webm":".webm","image/webp":".webp","font/woff":".woff","font/woff2":".woff2","application/xhtml+xml":".xhtml","application/vnd.ms-excel":".xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":".xlsx","RFC 7303":".xml","application/vnd.mozilla.xul+xml":".xul","application/zip":".zip","video/3gpp":".3gp","video/3gpp2":".3g2","application/x-7z-compressed":".7z"};async function*x(e){let{done:t,value:o}=await e.read();for(;!t;)yield o,{done:t,value:o}=await e.read()}function h(e){return f[e]??""}function w(e){return v[e]??"application/octet-stream"}async function y(e,t,o,a,i){const n=await fetch(e,a);if(!n.ok||n.body===null)throw new Error(await n.text());let p=[];for await(let c of x(n.body.getReader()))c!==void 0&&(o(c),p.push(c));const s=i??n.headers.get("Content-Type")??"application/octet-stream",r=t(e.toString(),s);return new File(p,r,{type:s})}async function b(e,t=()=>{},o){return y(`//static.dao3.fun/block/${e}`,(a,i)=>`${e}${h(i)}`,t,{mode:"cors"},o)}async function u(e,t){return await(await fetch("//static.dao3.fun/block/",{method:"POST",headers:{"Content-Type":t},body:e,mode:"cors"})).json()}async function E(e){return u(e,"text/plain")}async function z(e,t){const o=w("."+e.name.split(".").at(-1)),a=new FileReader;return new Promise((i,n)=>{a.addEventListener("load",async function(){const p=a.result;i(await u(p,o))}),a.addEventListener("error",async function(p){n(p)}),a.addEventListener("progress",t),a.readAsArrayBuffer(e)})}(async function(){let e=document.getElementById("read-hash"),t=document.querySelector(".read .tip"),o=document.querySelector(".read .preview .frame"),a=document.getElementById("read-hash-form"),i=document.getElementById("file-type");if(!e||!t||!o||!a||!i)throw new Error("是谁偷偷动了我的DOM？");let n=null,p=null;a==null||a.addEventListener("submit",async c=>{if(c.preventDefault(),e.value==""){t.innerText="请填入hash";return}let d=0;t.innerText="正在启动传输……";try{let l=i.value;(l=="auto"||l=="http")&&(l=null);let m=await b(e.value,g=>{d+=g.length,t.innerText=`已接收${d}字节……`},l);t.innerText=`传输完毕！大小：${m.size}字节，文件类型：${m.type}`,n=m.name,p=URL.createObjectURL(m),o.src=p}catch(l){t.innerText=`传输失败！${l}`}});let s=document.getElementById("open");s==null||s.addEventListener("click",()=>{open(`//static.dao3.fun/block/${e.value}`,"_blank")});let r=document.getElementById("download");r==null||r.addEventListener("click",async()=>{(!p||!n)&&a.submit();let c=document.createElement("a");c.href=p??"",c.download=n??"",c.click()});for(const[c,d]of Object.entries(f)){const l=document.createElement("option");l.innerText=`${c} (${d})`,l.value=c,i==null||i.appendChild(l)}})();(async function(){let e=document.getElementById("post-text"),t=document.querySelector(".post-text .tip"),o=document.getElementById("post-text-form");if(!e||!t||!o)throw new Error("是谁偷偷动了我的DOM？");o==null||o.addEventListener("submit",async a=>{a.preventDefault(),t.innerText="正在启动传输……";let i=await E(e.value);t.innerText=`传输成功！${JSON.stringify(i)}`})})();(async function(){let e=document.getElementById("post-file"),t=document.querySelector(".post-file .tip"),o=document.getElementById("post-file-form"),a=document.querySelector(".post-file .preview .frame");!e||!t||!o||!a||(e==null||e.addEventListener("change",i=>{if(!e.files||e.files.length==0)throw new Error("是谁偷偷动了我的DOM？");a.src=URL.createObjectURL(e.files[0])}),o==null||o.addEventListener("submit",async i=>{i.preventDefault(),t.innerText="传输中……";try{if(!e.files||e.files.length==0)throw new Error("未选择文件");const n=e.files;for(const p of n){const s=p.size,r=await z(p,c=>{t.innerText=`[${((s-c.loaded)/s*100).toFixed(0)}%] 共${s}字节，已传输${c.loaded}字节`});t.innerText=`传输成功！${JSON.stringify(r)}`}}catch(n){t.innerText=`错误：${n}`}}))})();(async function(){document.querySelectorAll(".preview").forEach(t=>{let o=t.querySelector(".change-preview-vis"),a=t.querySelector(".frame");if(!o||!a)throw new Error("是谁偷偷动了我的DOM？");o==null||o.addEventListener("click",()=>{a.classList.contains("hidden")?a.classList.remove("hidden"):a.classList.add("hidden")})})})();
